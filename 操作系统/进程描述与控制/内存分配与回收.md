# 内存分配与回收

内存的分配和回收是操作系统一个重要的作用。

## 内存的分配

内存的分配包含几种方式

### 单一连续的分配

这个方式是很早的方法了，现在基本上很少使用了，使用的就是顺序的分配，因为当时没有多道的程序设计。

### 固定的分配

就是将内存空间划分成若干的固定的区域，然后每一个分区给一个程序使用，互不干扰

### 动态的分配

根据进程的实际需要，动态的分配空间。

在这里我们需知道两个数据结构：

* 动态分区的空闲表数据结构：

  也就是一张表中，被占用的内存就是1，否则就是0

  ![image-20220526154642834](/Users/lizhongzheng/Library/Application Support/typora-user-images/image-20220526154642834.png)

* 动态分区的空闲链数据结构：

  ![image-20220526154701047](/Users/lizhongzheng/Library/Application Support/typora-user-images/image-20220526154701047.png)

## 动态分区分配算法

### 首次适应算法

也就是顺序的查找，如果没有找到合适的就查找失败。

因为是顺序的查找，所以我们要知道的事情是在动态的查找的时候，我们每次都会从头节点开始，这样的话越到后面我们需要查找的位置越来越后面，这样效率是很低的。

所以有稍微的改进，就是循环查找，下次查找就从上次结束的位置开始查找。

### 最佳适应算法

就是使用链表的方式，将空闲区的大小进行使用链表进行链接并排序，我们需要多大的内存我们就用那个内存。

### 快速适应算法

使用链表进行空闲区存储，我们将大小一样的空闲区存储到同一个链表中，然后需要那个大小的内存就去拿相应的内存

# 内存的回收

上面我们对内存进行了分配，然后当我们使用完后，我们就要进行内存的回收，在回收的时候，我们会遇见下面这几种情况。那么我们分别来说一下，每一种的回收方式。

![image-20220526155357208](/Users/lizhongzheng/Library/Application Support/typora-user-images/image-20220526155357208.png)

我们从左往右进行解释

### 回收区在空闲区下面

这个时候，会将空闲区的大小增大。不会创建一个新的节点。

### 回收区在空闲区上面

这个时候我们会先创建一个新的节点，新节点的地址为回收区的地址。

### 回收区在两个空闲区中间

这个时候，我们会将三个进行合并，然后使用空闲区1的地址作为这个空闲区的地址

### 单独的一个空闲区

直接创建一个新的节点，然后使用回收区的地址作为地址。