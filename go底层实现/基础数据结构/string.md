# String

今天学习了String，学习到很多的有趣的东西。

## String的底层结构

```go
type stringStruct struct {
	str unsafe.Pointer
	len int
}
```

这里我们通过runtime包来看string的结构，结构也很简单，就两个结构体成员，一个str一个len

### str unsafe.Pointer

这是一个指向底层数组的指针

### len int 

是底层数组的长度，这里我们需要注意的事情，底层数组是一个字节数组，里面存放的是字节，

在go中统一采用的是unicode编码，英文字母是一个字节，西方符号是两个字节，中文汉字三个字节，极少的情况出现四个字节。

## 获string元素

这里让我想起来了之前我的用法，我使用for来遍历，发现遍历不出自己想要的结果，今天发现了原因，因为在底层是字节数组，然后如果是中文的话，我们知道一个中文需要三个字节，然后这个时候，我们使用for去遍历的时候，我们出现的就是一个一个字节，所以我们得不到我们想要的结果。

### 使用range

我们这里使用range就可以得到我们想要的效果，我们这里需要知道的是，我们在使用range会调用runtime中的编码函数进行解码和编码。所以我们可以得到我们想要的结果。

## 对stirng进行切分

```go
s := string([]rune(s)[:3])
```

这里我们使用rune然后就会调用runtime的编码 函数这个时候会生成一个字符的数组，然后我们就可以进行切分了。

